{"issue":{"id":1252,"project":{"id":16,"name":"easySDI"},"tracker":{"id":1,"name":"Defect"},"status":{"id":10,"name":"Closed"},"priority":{"id":5,"name":"High"},"author":{"id":383,"name":"Blatti Yves"},"category":{"id":20,"name":"SHOP"},"fixed_version":{"id":177,"name":"4.4.0"},"subject":"Saving a basket is not handled in a single transaction -> REST service may fail","description":"Saving a basket is not handled in a single transaction, so when the REST extraction service gets the orders, it may have a partial order, or have missing elements (like pricing).\r\nI have joined an example of a curl client accessing the service on short interval while an order is saved, it shows:\r\n- 1) no new request\r\n- 2) request being saved (XML validation fails)\r\n- 3) request pricing being saved (XML validation fails)\r\n- 4) a new request is served\r\n- 5) no new request\r\n\r\nSteps 2 & 3 should never happen.\r\nI see two ways for resolving it:\r\n- save the order in a single transaction (complete model/controler rewrite)\r\n- use a sort of flag, the the service would check, or the sent date for example\r\n\r\nNote: the WPS may be affected too. Not tested yet.","start_date":"2016-02-01","done_ratio":100,"custom_fields":[{"id":2,"name":"Affected version","value":"172"}],"created_on":"2016-02-01T12:35:03Z","updated_on":"2017-10-27T06:32:14Z","closed_on":"2016-02-22T09:34:28Z","journals":[{"id":7140,"user":{"id":383,"name":"Blatti Yves"},"notes":"Will use the second method proposed: set the time at @0000-00-00 00:00:00@ on order creation, then correct it in _finalizeSave()_.\r\nThe WPS and REST then get orders only with sent date > @0000-00-00 00:00:00@","created_on":"2016-02-03T10:31:06Z","details":[{"property":"attr","name":"status_id","old_value":"1","new_value":"2"},{"property":"attr","name":"fixed_version_id","new_value":"177"}]},{"id":7141,"user":{"id":383,"name":"Blatti Yves"},"notes":"fixed at rev. 9445\r\n\r\n(also fixed a small string error in Easysdi_shopHelper : MOD_EASYSDI_LASTORDERS_TIME_NOW -> COM_EASYSDI_SHOP_TIME_NOW )","created_on":"2016-02-03T10:41:56Z","details":[{"property":"attr","name":"status_id","old_value":"2","new_value":"3"},{"property":"attr","name":"done_ratio","old_value":"0","new_value":"100"}]},{"id":7256,"user":{"id":383,"name":"Blatti Yves"},"created_on":"2016-02-22T08:03:21Z","details":[{"property":"attr","name":"status_id","old_value":"3","new_value":"12"}]},{"id":7272,"user":{"id":383,"name":"Blatti Yves"},"created_on":"2016-02-22T08:05:07Z","details":[{"property":"attr","name":"assigned_to_id","old_value":"383","new_value":"23"}]},{"id":7286,"user":{"id":23,"name":"Van Hoecke H\u00e9l\u00e8ne "},"created_on":"2016-02-22T09:34:28Z","details":[{"property":"attr","name":"status_id","old_value":"12","new_value":"10"}]},{"id":7514,"user":{"id":23,"name":"Van Hoecke H\u00e9l\u00e8ne "},"created_on":"2016-03-31T06:16:14Z","details":[{"property":"attr","name":"assigned_to_id","old_value":"23"}]},{"id":8304,"user":{"id":383,"name":"Blatti Yves"},"notes":"","created_on":"2017-10-27T06:31:45Z","details":[{"property":"attachment","name":"983","old_value":"multiple_call_to_rest_service.log"}]},{"id":8305,"user":{"id":383,"name":"Blatti Yves"},"notes":"","created_on":"2017-10-27T06:32:14Z","details":[{"property":"attachment","name":"1060","new_value":"multiple_call_to_rest_service.log"}]}]}}