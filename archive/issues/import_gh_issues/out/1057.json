{"issue":{"id":1057,"project":{"id":16,"name":"easySDI"},"tracker":{"id":1,"name":"Defect"},"status":{"id":1,"name":"New"},"priority":{"id":4,"name":"Normal"},"author":{"id":23,"name":"Van Hoecke H\u00e9l\u00e8ne "},"category":{"id":12,"name":"CORE"},"subject":"Missing indexes in sql server database schema","description":"There is some missing indexes in the SQL server database schema. \r\n\r\nFor example, #__sdi_resource and its related tables don't have indexes on foreign keys, which are usefull for the queries executed to build the resources page.","start_date":"2015-07-07","done_ratio":0,"custom_fields":[{"id":2,"name":"Affected version","value":"173"}],"created_on":"2015-07-07T07:00:26Z","updated_on":"2015-07-21T13:09:19Z","journals":[{"id":5771,"user":{"id":23,"name":"Van Hoecke H\u00e9l\u00e8ne "},"notes":"A solution is to run this query that creates all missing index on foreign keys :\r\n<pre>\r\nSelect\r\n'IF NOT EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N''[dbo].['\r\n+ tab.[name]\r\n+ ']'') AND name = N''IX_'\r\n+ cols.[name]\r\n+ ''') '\r\n+ 'CREATE NONCLUSTERED INDEX [IX_'\r\n+ cols.[name]\r\n+ '] ON [dbo].['\r\n+ tab.[name]\r\n+ ']( ['\r\n+ cols.[name]\r\n+ '] ASC ) WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]'\r\nFrom sys.foreign_keys keys\r\nInner Join sys.foreign_key_columns keyCols\r\nOn keys.object_id = keyCols.constraint_object_id\r\nInner Join sys.columns cols\r\nOn keyCols.parent_object_id = cols.object_id\r\nAnd keyCols.parent_column_id = cols.column_id\r\nInner Join sys.tables tab\r\nOn keyCols.parent_object_id = tab.object_id\r\nOrder by tab.[name], cols.[name]\r\n</pre>","created_on":"2015-07-21T13:09:19Z","details":[]}]}}