{"issue":{"id":1216,"project":{"id":16,"name":"easySDI"},"tracker":{"id":3,"name":"Enhancement"},"status":{"id":10,"name":"Closed"},"priority":{"id":4,"name":"Normal"},"author":{"id":383,"name":"Blatti Yves"},"category":{"id":20,"name":"SHOP"},"fixed_version":{"id":179,"name":"4.4.1"},"subject":"Distinguish the 'archived' state of an order from order status","description":"Distinguish the 'archived' state from order status.\r\n\r\nThis will allow the user to:\r\n* have 'active' and 'archived' orders (like in a mailbox) + the boolean filter (same look as for validations : !boolean_filter.png!)\r\n* have a coherent module (last orders, which will contain only last active orders)\r\n* be able to archive order in states : 'finish', 'rejected by TP' and 'rejected by provider' (= ANY of the end of order life cycle)\r\n* don't loose informations on the history of the order depending of it's archive state\r\n\r\nThat is the behavior we wanted in v4 workshop, but since we added new order status the process has now branches, and we cannot rely on the order status anymore. See:\r\n\r\n<pre>\r\nV4.2.X order status : we can use the archive state\r\n    +------+     +------+           +------+     +--------+\r\n    |      +---->+      +---....--->+finish+---->+archived|\r\n    +------+     +------+           +------+     +--------+\r\n\r\nV4.3.x oreder status : cannot use the archive status for views,\r\n                       since we cannot archive rejected orders\r\n                                    +-------------+\r\n                               .--->|rej. by supl.|\r\n                               .    +-------------+\r\n                               .\r\n    +------+     +------+      .    +------+     +--------+\r\n    |      +---->+      +---....--->+finish+---->+archived|\r\n    +------+     +------+      .    +------+     +--------+\r\n                               .\r\n                               .    +-------------+\r\n                               .--->+rej. by TP   |\r\n                                    +-------------+\r\n</pre>\r\n\r\nh2. Implications\r\n\r\nIn the code:\r\n* add the boolean filter in orders view\r\n* only show active order in the 'last orders module' (#1078)\r\n* change the archive method controller, and allow it in view from any end status\r\n* remove archived status from constants and tests\r\n\r\nThe sql update plan is:\r\n* add the new field ( archived(boolean) )\r\n* set the archived flag to all orders that are in archived status\r\n* set status to 'finish' to all 'archived' orders (the only state they could have been in before!)\r\n* delete the archive status from the sys table","start_date":"2015-12-04","done_ratio":100,"custom_fields":[{"id":3,"name":"Sponsor","multiple":true,"value":["ASIT-VD (CH)"]},{"id":4,"name":"Functional impact","value":"- Remove the archived status for orders lifecycles\r\n- Add a new flag for archived orders"},{"id":5,"name":"Ergonomic impact","value":"User will be able to archive any orders that have reached one end of the life cycle"}],"created_on":"2015-12-04T08:04:39Z","updated_on":"2016-03-31T06:18:18Z","closed_on":"2016-03-29T08:21:30Z","journals":[{"id":6856,"user":{"id":383,"name":"Blatti Yves"},"notes":"","created_on":"2015-12-04T08:04:55Z","details":[{"property":"attr","name":"category_id","new_value":"20"},{"property":"attr","name":"status_id","old_value":"1","new_value":"7"},{"property":"attr","name":"assigned_to_id","new_value":"762"}]},{"id":6871,"user":{"id":23,"name":"Van Hoecke H\u00e9l\u00e8ne "},"notes":"","created_on":"2015-12-04T10:42:47Z","details":[{"property":"attr","name":"assigned_to_id","old_value":"762","new_value":"383"}]},{"id":6893,"user":{"id":383,"name":"Blatti Yves"},"notes":"We talked about the Thomas proposals (Using different filters in views) at ASIT VD,\r\nbut we cannot fit all use cases (ex: Canceled and Rejected, will be there forever, they'll never be archived).\r\n\r\nWe also had a look of the implications in code, and it seems lighter than we imagined.\r\n ","created_on":"2015-12-10T14:01:19Z","details":[{"property":"attr","name":"assigned_to_id","old_value":"383","new_value":"762"}]},{"id":6942,"user":{"id":16,"name":"Portier Thomas"},"notes":"+1","created_on":"2015-12-14T13:40:24Z","details":[]},{"id":7011,"user":{"id":23,"name":"Van Hoecke H\u00e9l\u00e8ne "},"notes":"+1","created_on":"2016-01-14T13:28:49Z","details":[]},{"id":7012,"user":{"id":23,"name":"Van Hoecke H\u00e9l\u00e8ne "},"notes":"TC has accepted the enhancement according to Yves' proposal","created_on":"2016-01-14T13:29:59Z","details":[{"property":"attr","name":"status_id","old_value":"7","new_value":"9"},{"property":"attr","name":"assigned_to_id","old_value":"762","new_value":"383"}]},{"id":7441,"user":{"id":23,"name":"Van Hoecke H\u00e9l\u00e8ne "},"notes":"","created_on":"2016-03-29T08:20:54Z","details":[{"property":"attr","name":"status_id","old_value":"9","new_value":"2"},{"property":"attr","name":"assigned_to_id","old_value":"383","new_value":"23"},{"property":"attr","name":"fixed_version_id","new_value":"179"}]},{"id":7442,"user":{"id":23,"name":"Van Hoecke H\u00e9l\u00e8ne "},"notes":"","created_on":"2016-03-29T08:21:06Z","details":[{"property":"attr","name":"status_id","old_value":"2","new_value":"3"},{"property":"attr","name":"done_ratio","old_value":"0","new_value":"100"},{"property":"cf","name":"3","new_value":"ASIT-VD (CH)"}]},{"id":7443,"user":{"id":23,"name":"Van Hoecke H\u00e9l\u00e8ne "},"notes":"","created_on":"2016-03-29T08:21:30Z","details":[{"property":"attr","name":"status_id","old_value":"3","new_value":"10"},{"property":"attr","name":"assigned_to_id","old_value":"23"}]}]}}