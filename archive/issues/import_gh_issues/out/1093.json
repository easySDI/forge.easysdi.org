{"issue":{"id":1093,"project":{"id":16,"name":"easySDI"},"tracker":{"id":3,"name":"Enhancement"},"status":{"id":10,"name":"Closed"},"priority":{"id":5,"name":"High"},"author":{"id":383,"name":"Blatti Yves"},"category":{"id":20,"name":"SHOP"},"fixed_version":{"id":176,"name":"4.3.2"},"subject":"Add the ability to have custom code in basket and order (recapitulation) view","description":"Add the ability to have custom code in basket and order (recapitulation) view.\r\nThe idea is to add a custom plugin trigger to get custom JS code in views having a map.\r\nThis would allow integrator to add code in basket map etc. For example: custom layer switcher, custom search box...","start_date":"2015-08-25","done_ratio":100,"custom_fields":[{"id":3,"name":"Sponsor","multiple":true,"value":[]},{"id":4,"name":"Functional impact","value":"An integrator can code a plugin to add custom code in SHOP views having a map."},{"id":5,"name":"Ergonomic impact","value":"No impact for users without plugin."}],"created_on":"2015-08-25T06:54:36Z","updated_on":"2015-09-18T15:21:06Z","closed_on":"2015-09-11T13:56:58Z","journals":[{"id":5978,"user":{"id":23,"name":"Van Hoecke H\u00e9l\u00e8ne "},"notes":"TC has validated this enhancement","created_on":"2015-08-28T08:10:41Z","details":[{"property":"attr","name":"status_id","old_value":"7","new_value":"9"},{"property":"attr","name":"assigned_to_id","old_value":"762","new_value":"383"}]},{"id":6066,"user":{"id":383,"name":"Blatti Yves"},"notes":"","created_on":"2015-09-09T18:08:17Z","details":[{"property":"attr","name":"status_id","old_value":"9","new_value":"2"}]},{"id":6067,"user":{"id":383,"name":"Blatti Yves"},"notes":"Basket Plugin : rev. 9048","created_on":"2015-09-09T18:09:07Z","details":[{"property":"attr","name":"done_ratio","old_value":"0","new_value":"50"}]},{"id":6068,"user":{"id":383,"name":"Blatti Yves"},"notes":"Recap plugin : rev. 9056","created_on":"2015-09-10T11:52:31Z","details":[{"property":"attr","name":"status_id","old_value":"2","new_value":"3"},{"property":"attr","name":"done_ratio","old_value":"50","new_value":"100"}]},{"id":6069,"user":{"id":383,"name":"Blatti Yves"},"notes":"Since there's thwo structures of views:\r\n* The basket view\r\n* The \"recap\" views (order, validation & request)\r\n\r\nEach have it's plugin type!\r\n\r\nIf one want's to have a JS plugin for it's SHOP:\r\n\r\nFor basket:\r\n- create a plugin in folder @easysdi_basket_script@\r\n- the plug has to offer a method @public function getBasketScript()@ that returns javascript as String\r\nFor recaps:\r\n- create a plugin in folder @easysdi_recap_script@\r\n- the plug has to offer a method @public function getRecapScript($context)@ that returns javascript as String\r\n- context var contains the 'viewType' constant (see easysdi_shop_helper) : usage example @if(Easysdi_shopHelper::ORDERVIEW_ORDER == $context->viewType)@\r\nNotes:\r\n- this mechanism does not alter current users if they're not using plugins\r\n- multiple plugins can be loaded of each types, scripts are concatenated.\r\n- plugins can add interact with DOM document (for example: @$document->addScript(Juri::base(true) . '/components/com_asitvd_simpleshop/libraries/autocomplete/jquery.autocomplete.min.js');@)\r\n\r\nA plugin example: file @joomlaROOT/plugins/easysdi_recap_script/asitvdrecap/asitvdrecap.php@\r\n\r\n<pre>\r\n<code class=\"php\">\r\ndefined('_JEXEC') or die;\r\n\r\n//shop helper for view types constants\r\nrequire_once JPATH_SITE . '/components/com_easysdi_shop/helpers/easysdi_shop.php';\r\n\r\nclass PlgEasysdi_recap_scriptAsitvdrecap extends JPlugin {\r\n    public function getRecapScript($context) {\r\n        //only display in 'order' view (client view)\r\n        if (Easysdi_shopHelper::ORDERVIEW_ORDER == $context->viewType) {\r\n            //add some JS files\r\n            $document = JFactory::getDocument();\r\n            $document->addScript(Juri::base(true) . '/components/com_asitvd_simpleshop/libraries/autocomplete/jquery.autocomplete.min.js');\r\n            $document->addScript(Juri::base(true) . '/plugins/easysdi_recap_script/asitvdrecap/asitvdrecap.js');\r\n\r\n            //run the initialisation method of asitvdrecap.js\r\n            return 'asitvdrecapInit();';\r\n        } else {\r\n            //no script for other views\r\n            return '';\r\n        }\r\n    }\r\n\r\n}\r\n</code>\r\n</pre>","created_on":"2015-09-10T12:06:33Z","details":[]},{"id":6082,"user":{"id":383,"name":"Blatti Yves"},"notes":"","created_on":"2015-09-11T12:39:48Z","details":[{"property":"attr","name":"status_id","old_value":"3","new_value":"12"},{"property":"attr","name":"assigned_to_id","old_value":"383","new_value":"23"}]},{"id":6085,"user":{"id":23,"name":"Van Hoecke H\u00e9l\u00e8ne "},"created_on":"2015-09-11T13:55:18Z","details":[{"property":"attr","name":"fixed_version_id","new_value":"176"}]},{"id":6097,"user":{"id":23,"name":"Van Hoecke H\u00e9l\u00e8ne "},"created_on":"2015-09-11T13:56:58Z","details":[{"property":"attr","name":"status_id","old_value":"12","new_value":"10"}]},{"id":6213,"user":{"id":23,"name":"Van Hoecke H\u00e9l\u00e8ne "},"created_on":"2015-09-18T15:15:10Z","details":[{"property":"attr","name":"assigned_to_id","old_value":"23"}]}]}}